<h1 class="margin-padding">My applications</h1>
<div class="container py-4">
  <div class="row">
    <div class="col-12">
      <div class="card search-form">
        <div class="card-body p-0">
          <%= form_with url: offers_path, method: :get, id:"search-form", class: "d-flex" do %>
            <%= text_field_tag :query, params[:query], class: "form-control", placeholder: "Find an offer by Tag: part-time, full-time, any OR by title" %>
            <%= submit_tag "Search", class: "btn btn-outline-primary" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      <div class="card card-margin">
        <div class="card-body">
          <div class="row search-body">
            <div class="col-12">
              <div class="search-result">
                <div class="result-body">
                    <table class="table table-hover widget-26-app">
                      <thead class="d-flex align-items-center">
                        <tr class="d-flex align-items-center justify-content-between row">
                          <th class="px-2 col" scope="col">Applicant</th>
                          <th class="px-2 col" scope="col">Offer</th>
                          <th class="px-2 col" scope="col">Status</th>
                          <th class="px-2 col" scope="col">Actions</th>
                        </tr>
                      </thead>
                      <% @applications.each do |application| %>
                        <tbody class="d-flex align-items-center">
                          <tr class="d-flex align-items-center justify-content-between row">
                            <td class="px-2 col">
                              <div class="widget-26-job-application">
                                <span><%= application.assistant.firstname %> <%= application.assistant.lastname %></span>
                              </div>
                            </td>
                            <td class="px-2 col">
                              <div class="widget-26-job-application offer">
                                <p><%= application.offer.description %></p>
                              </div>
                            </td>
                            <td class="px-2 col">
                              <div class="widget-26-job-application">
                                <h6 class="mb-0"><span class="badge bg-success"><%= application.status %></span></h6>
                              </div>
                            </td>
                            <td class="px-2 col">
                              <div class="widget-26-job-application">
                                <% if current_user.type_of_user == 'Company' %>
                                </div>
                                  <%= link_to "", edit_application_path(application), class:"fas fa-check text-success" %>
                                  <%= link_to "", application_path(application), method: :delete, data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class:"fas fa-trash-alt text-danger" %>
                                <% elsif application.status == 'Interview' %>
                                  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
                                  <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
                                  <a href="" onclick="Calendly.initPopupWidget({url: 'https://calendly.com/ignaciozanotto/consulta-particular'});return false;">Schedule your interview</a>
                                <% else %>
                                  <%= link_to "", application_path(application), method: :delete, data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: "card-link" %>
                                <% end %>
                            </td>
                          </tr>
                        </tbody>
                      <% end %>
                    </table>
                </div>
              </div>
            </div>
          </div>
          <nav class="d-flex justify-content-center">
            <ul class="pagination pagination-base pagination-boxed pagination-square mb-0">
              <li class="page-item">
                <a class="page-link no-border" href="#">
                  <span aria-hidden="true">«</span>
                  <span class="sr-only">Previous</span>
                </a>
              </li>
              <li class="page-item active"><a class="page-link no-border" href="#">1</a></li>
              <li class="page-item"><a class="page-link no-border" href="#">2</a></li>
              <li class="page-item"><a class="page-link no-border" href="#">3</a></li>
              <li class="page-item"><a class="page-link no-border" href="#">4</a></li>
              <li class="page-item">
                <a class="page-link no-border" href="#">
                  <span aria-hidden="true">»</span>
                  <span class="sr-only">Next</span>
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>
